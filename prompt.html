<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prompt Engineering Assistant</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Custom scrollbar for webkit browsers */
        .custom-scrollbar::-webkit-scrollbar {
            width: 8px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #1e293b; /* slate-800 */
            border-radius: 10px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #475569; /* slate-600 */
            border-radius: 10px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #64748b; /* slate-500 */
        }
        /* Simple pulsing animation for the loader */
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
        }
        .loader-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
    </style>
</head>
<body class="bg-slate-900 text-slate-200 flex items-center justify-center min-h-screen">
    <div class="w-full max-w-4xl mx-auto p-4 md:p-8">
        <div class="bg-slate-800 border border-slate-700 rounded-2xl shadow-lg p-6 md:p-8">
            
            <!-- Header Section -->
            <div class="text-center mb-8">
                <h1 class="text-3xl md:text-4xl font-bold text-slate-100">Prompt Engineering Assistant</h1>
                <p class="text-slate-400 mt-2">Enter a basic idea, and I'll enhance it into a powerful, well-structured prompt.</p>
            </div>

            <!-- Input Section -->
            <div class="mb-6">
                <label for="user-prompt" class="block text-lg font-semibold text-slate-300 mb-2">Your Basic Prompt</label>
                <textarea id="user-prompt" rows="5" class="w-full p-4 bg-slate-700 border border-slate-600 text-slate-100 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 custom-scrollbar resize-none placeholder-slate-500" placeholder="e.g., write a story about a space cat"></textarea>
            </div>

            <!-- Action Button -->
            <div class="text-center mb-6">
                <button id="enhance-button" class="bg-blue-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-4 focus:ring-blue-500 focus:ring-opacity-50 transition-transform transform hover:scale-105">
                    âœ¨ Enhance Prompt
                </button>
            </div>

            <!-- Output Section -->
            <div>
                <label for="enhanced-prompt" class="block text-lg font-semibold text-slate-300 mb-2">Enhanced Prompt</label>
                <div id="output-container" class="relative bg-slate-900 border border-slate-700 rounded-lg p-4 min-h-[150px] custom-scrollbar overflow-y-auto">
                    <!-- Loading State -->
                    <div id="loader" class="hidden absolute inset-0 bg-slate-900 bg-opacity-80 flex items-center justify-center flex-col text-center p-4">
                       <svg class="animate-spin h-8 w-8 text-blue-500 mb-3" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                        </svg>
                        <p class="text-slate-400 font-medium loader-pulse">Enhancing your prompt...</p>
                        <p class="text-sm text-slate-500">This might take a moment.</p>
                    </div>
                    <!-- Error Message -->
                     <div id="error-message" class="hidden text-center text-red-500 p-4">
                        <p class="font-bold">Oops! Something went wrong.</p>
                        <p id="error-text" class="text-sm"></p>
                    </div>
                    <!-- Output Content -->
                    <div id="prompt-output" class="text-slate-300 whitespace-pre-wrap">
                        <p class="text-slate-500">Your enhanced prompt will appear here...</p>
                    </div>
                    <!-- Copy Button -->
                    <button id="copy-button" class="hidden absolute top-3 right-3 bg-slate-700 hover:bg-slate-600 text-slate-300 font-semibold py-1 px-3 rounded-md text-sm transition-colors">
                        Copy
                    </button>
                </div>
            </div>
        </div>
        <footer class="text-center mt-6 text-sm text-slate-500">
            <p>Powered by Google's Gemini Model</p>
        </footer>
    </div>

    <script>
        // DOM Element References
        const userPromptInput = document.getElementById('user-prompt');
        const enhanceButton = document.getElementById('enhance-button');
        const outputContainer = document.getElementById('output-container');
        const promptOutput = document.getElementById('prompt-output');
        const copyButton = document.getElementById('copy-button');
        const loader = document.getElementById('loader');
        const errorMessage = document.getElementById('error-message');
        const errorText = document.getElementById('error-text');

        // --- Event Listeners ---
        
        // Main button click handler
        enhanceButton.addEventListener('click', handleEnhancePrompt);

        // Copy button click handler
        copyButton.addEventListener('click', handleCopy);

        // --- Core Functions ---

        /**
         * Main function to handle the prompt enhancement process.
         */
        async function handleEnhancePrompt() {
            const userPrompt = userPromptInput.value.trim();
            if (!userPrompt) {
                showError("Please enter a prompt first.");
                return;
            }
            
            showLoadingState(true);
            hideError();

            try {
                // This is the "meta-prompt" that instructs the model how to behave.
                const metaPrompt = `You are an expert prompt engineer. Your task is to take a user's simple idea and transform it into a detailed, well-structured, and effective prompt for a generative AI. 
                
                When rewriting, consider the following principles:
                1.  **Role & Goal:** Clearly define the AI's role (e.g., "You are a travel blogger," "You are a senior software engineer").
                2.  **Context:** Provide background information to set the scene.
                3.  **Task:** Be explicit about what the AI needs to do. Use action verbs.
                4.  **Constraints:** Specify limitations, such as word count, tone of voice, or things to avoid.
                5.  **Format:** Define the desired output structure (e.g., markdown, JSON, a list of bullet points).
                6.  **Examples:** Provide a clear example of the desired output if possible.

                Now, take the following user prompt and enhance it based on these principles.

                Remember to ONLY respond with the improved prompt and NOTHING ELSE STRICTLY!

                User's Prompt: "${userPrompt}"`;

                // API call to Gemini
                const enhancedPrompt = await callGeminiAPI(metaPrompt);
                
                // Display the result
                displayResult(enhancedPrompt);

            } catch (error) {
                console.error("Error calling Gemini API:", error);
                showError(error.message || "An unknown error occurred. Please check the console.");
            } finally {
                showLoadingState(false);
            }
        }

        /**
         * Calls the Gemini API to generate the enhanced prompt.
         * @param {string} prompt - The full prompt to send to the model.
         * @returns {Promise<string>} The generated text from the model.
         */
        async function callGeminiAPI(prompt) {
            const apiKey = ""; // API key is handled by the execution environment
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
            
            const payload = {
                contents: [{
                    role: "user",
                    parts: [{ text: prompt }]
                }],
                generationConfig: {
                    temperature: 0.7,
                    topK: 1,
                    topP: 1,
                    maxOutputTokens: 8192,
                }
            };

            const response = await fetch(apiUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });

            if (!response.ok) {
                const errorData = await response.json();
                throw new Error(errorData.error?.message || `HTTP error! status: ${response.status}`);
            }

            const result = await response.json();

            if (result.candidates && result.candidates.length > 0 &&
                result.candidates[0].content && result.candidates[0].content.parts &&
                result.candidates[0].content.parts.length > 0) {
                return result.candidates[0].content.parts[0].text;
            } else {
                // This handles cases where the API returns a 200 OK but no valid content,
                // for example, due to safety settings blocking the response.
                const finishReason = result.candidates?.[0]?.finishReason;
                if (finishReason === 'SAFETY') {
                    throw new Error("The response was blocked due to safety settings. Please modify your prompt.");
                }
                throw new Error("The API returned an unexpected response structure.");
            }
        }

        /**
         * Copies the enhanced prompt text to the clipboard.
         */
        function handleCopy() {
            const textToCopy = promptOutput.textContent;
            
            // A fallback for navigator.clipboard which might not work in all iframe contexts
            const textArea = document.createElement("textarea");
            textArea.value = textToCopy;
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            try {
                document.execCommand('copy');
                copyButton.textContent = 'Copied!';
                setTimeout(() => { copyButton.textContent = 'Copy'; }, 2000);
            } catch (err) {
                console.error('Fallback: Oops, unable to copy', err);
                showError("Could not copy text.");
            }
            document.body.removeChild(textArea);
        }

        // --- UI Helper Functions ---

        /**
         * Toggles the visibility of the loading indicator.
         * @param {boolean} isLoading - Whether to show or hide the loader.
         */
        function showLoadingState(isLoading) {
            if (isLoading) {
                loader.classList.remove('hidden');
                enhanceButton.disabled = true;
                enhanceButton.classList.add('opacity-50', 'cursor-not-allowed');
            } else {
                loader.classList.add('hidden');
                enhanceButton.disabled = false;
                enhanceButton.classList.remove('opacity-50', 'cursor-not-allowed');
            }
        }

        /**
         * Displays the final enhanced prompt in the output area.
         * @param {string} text - The text to display.
         */
        function displayResult(text) {
            promptOutput.textContent = text;
            copyButton.classList.remove('hidden');
        }
        
        /**
         * Shows an error message in the UI.
         * @param {string} message - The error message to display.
         */
        function showError(message) {
            promptOutput.innerHTML = `<p class="text-slate-500">Your enhanced prompt will appear here...</p>`;
            copyButton.classList.add('hidden');
            errorMessage.classList.remove('hidden');
            errorText.textContent = message;
        }

        /**
         * Hides the error message.
         */
        function hideError() {
            errorMessage.classList.add('hidden');
            errorText.textContent = '';
        }

    </script>
</body>
</html>
